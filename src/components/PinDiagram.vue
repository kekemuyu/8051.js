<template>
  <div id="pin-diagram">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 683.2 1043" version="1">
      <g font-size="40" font-family="sans-serif" letter-spacing="0" word-spacing="0">
        <text x="585.4" y="29.5" transform="translate(.586 .183)">
          <tspan x="585.4" y="29.5">Vcc</tspan>
        </text>
        <text x="581.8" y="1035.2" transform="translate(.586 .183)">
          <tspan x="581.8" y="1035.2">P2.0</tspan>
        </text>
        <text x="581.8" y="982.6" transform="translate(.586 .183)">
          <tspan x="581.8" y="982.6">P2.1</tspan>
        </text>
        <text x="581.8" y="930" transform="translate(.586 .183)">
          <tspan x="581.8" y="930">P2.2</tspan>
        </text>
        <text x="581.8" y="876.9" transform="translate(.586 .183)">
          <tspan x="581.8" y="876.9">P2.3</tspan>
        </text>
        <text x="581.8" y="824.3" transform="translate(.586 .183)">
          <tspan x="581.8" y="824.3">P2.4</tspan>
        </text>
        <text x="581.8" y="771.1" transform="translate(.586 .183)">
          <tspan x="581.8" y="771.1">P2.5</tspan>
        </text>
        <text x="581.8" y="717.9" transform="translate(.586 .183)">
          <tspan x="581.8" y="717.9">P2.6</tspan>
        </text>
        <text x="581.8" y="665.3" transform="translate(.586 .183)">
          <tspan x="581.8" y="665.3">P2.7</tspan>
        </text>
        <text x="581.8" y="612.2" transform="translate(.586 .183)">
          <tspan x="581.8" y="612.2">PSEN</tspan>
        </text>
        <text x="585.4" y="559.6" transform="translate(.586 .183)">
          <tspan x="585.4" y="559.6">ALE</tspan>
        </text>
        <text x="581.8" y="507.5" transform="translate(.586 .183)">
          <tspan x="581.8" y="507.5">EA</tspan>
        </text>
        <text x="581.8" y="82.7" transform="translate(.586 .183)">
          <tspan x="581.8" y="82.7">P0.0</tspan>
        </text>
        <text x="581.8" y="135.8" transform="translate(.586 .183)">
          <tspan x="581.8" y="135.8">P0.1</tspan>
        </text>
        <text x="581.8" y="189" transform="translate(.586 .183)">
          <tspan x="581.8" y="189">P0.2</tspan>
        </text>
        <text x="581.8" y="242.2" transform="translate(.586 .183)">
          <tspan x="581.8" y="242.2">P0.3</tspan>
        </text>
        <text x="581.8" y="295.3" transform="translate(.586 .183)">
          <tspan x="581.8" y="295.3">P0.4</tspan>
        </text>
        <text x="581.8" y="348.5" transform="translate(.586 .183)">
          <tspan x="581.8" y="348.5">P0.5</tspan>
        </text>
        <text x="581.8" y="401.7" transform="translate(.586 .183)">
          <tspan x="581.8" y="401.7">P0.6</tspan>
        </text>
        <text x="581.8" y="454.8" transform="translate(.586 .183)">
          <tspan x="581.8" y="454.8">P0.7</tspan>
        </text>
      </g>
      <g font-size="40" font-family="sans-serif" letter-spacing="0" word-spacing="0">
        <text x="581.4" y="29.5" transform="translate(-582.98 .182)">
          <tspan x="581.4" y="29.5">P1.0</tspan>
        </text>
        <text x="581.8" y="1035.2" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="1035.2">GND</tspan>
        </text>
        <text x="581.8" y="982.6" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="982.6">XTAL1</tspan>
        </text>
        <text x="581.8" y="930" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="930">XTAL2</tspan>
        </text>
        <text x="581.8" y="876.9" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="876.9">P3.7</tspan>
        </text>
        <text x="581.8" y="824.3" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="824.3">P3.6</tspan>
        </text>
        <text x="581.8" y="771.1" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="771.1">P3.5</tspan>
        </text>
        <text x="581.8" y="717.9" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="717.9">P3.4</tspan>
        </text>
        <text x="581.8" y="665.3" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="665.3">P3.3</tspan>
        </text>
        <text x="581.8" y="612.2" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="612.2">P3.2</tspan>
        </text>
        <text x="585.4" y="559.6" transform="translate(-582.98 .182)">
          <tspan x="585.4" y="559.6">P3.1</tspan>
        </text>
        <text x="581.8" y="507.5" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="507.5">P3.0</tspan>
        </text>
        <text x="581.8" y="82.7" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="82.7">P1.1</tspan>
        </text>
        <text x="581.8" y="135.8" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="135.8">P1.2</tspan>
        </text>
        <text x="581.8" y="189" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="189">P1.3</tspan>
        </text>
        <text x="581.8" y="242.2" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="242.2">P1.4</tspan>
        </text>
        <text x="581.8" y="295.3" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="295.3">P1.5</tspan>
        </text>
        <text x="581.8" y="348.5" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="348.5">P1.6</tspan>
        </text>
        <text x="581.8" y="401.7" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="401.7">P1.7</tspan>
        </text>
        <text x="581.8" y="454.8" transform="translate(-582.98 .182)">
          <tspan x="581.8" y="454.8">RST</tspan>
        </text>
      </g>
      <rect width="399" height="1040.1" x="-571.5" y="7.3" fill="none" stroke="#000" transform="matrix(-1 0 0 1 -19.746 -4.887)" ry="5.2" rx="4.3"></rect>
      <g fill="none" stroke="#000">
        <g transform="translate(-19.746 -3.816)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="high"></circle>
        </g>
        <g transform="translate(-19.746 50.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port00" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 102.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port01" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 156.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port02" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 208.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port03" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 260.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port04" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 314.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port05" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 368.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port06" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 422.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port07" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 474.184)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="low"></circle>
        </g>
        <g transform="translate(-19.746 524.184)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="low"></circle>
        </g>
        <g transform="translate(-19.746 578.184)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="low"></circle>
        </g>
        <g transform="translate(-19.746 632.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port27" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 684.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port26" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 738.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port25" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 792.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port24" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 844.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port23" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 896.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port22" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 948.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port21" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="translate(-19.746 1002.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port20" cx="590" cy="19.3" r="9.2"></circle>
        </g>
      </g>
      <g fill="none" stroke="#000">
        <g transform="matrix(-1 0 0 1 724.348 -3.816)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port10" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 50.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port11" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 102.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port12" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 156.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port13" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 208.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port14" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 260.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port15" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 314.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port16" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 368.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port17" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 422.184)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="low"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 474.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port30" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 524.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port31" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 578.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port32" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 632.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port33" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 684.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port34" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 738.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port35" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 792.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port36" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 844.184)">
          <path d="M572 19.3h9.6"></path>
          <circle id="port37" cx="590" cy="19.3" r="9.2"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 896.184)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="low"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 948.184)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="low"></circle>
        </g>
        <g transform="matrix(-1 0 0 1 724.348 1002.184)">
          <path d="M572 19.3h9.6"></path>
          <circle cx="590" cy="19.3" r="9.2" class="low"></circle>
        </g>
      </g>
    </svg>
  </div>
</template>

<script>
import { mapGetters } from 'vuex';
import _ from 'lodash';

export default {
  computed: mapGetters([
    'getP0',
    'getP1',
    'getP2',
    'getP3',
  ]),
  mounted() {
    const toBin = this.$store.state.utils.convertToBin;
    this.$store.subscribe(() => {
      _.forEach(_.range(4), (i) => {
        const port = toBin(this[`getP${i}`]());
        _.forEach(_.range(8), (j) => {
          const elt = this.$el.querySelector(`#port${i}${j}`);
          elt.setAttribute('class', port[7 - j] === '1' ? 'high' : 'low');
        });
      });
    });
  },
};
</script>

<style lang="scss" scoped>
svg {
  width: 100%;
  height: 100%;
}

.high {
  fill: red;
}

.low {
  fill: none;
}
</style>
